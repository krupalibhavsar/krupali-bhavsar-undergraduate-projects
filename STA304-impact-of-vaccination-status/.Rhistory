usethis::use_git_ignore()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(dplyr)
library(knitr)
library(patchwork)
library(tidyr)
library(haven)
library(FrF2)
library(BsMD)
library(gridExtra)
raw_data <- haven::read_dta("/Users/krupalibhavsar/Desktop/STA304/paper 3/gss_analysis/inputs/data/2021_stata/gss2021.dta")
# extracting the variables I am concerned with, no response
reduced_data <-
raw_data %>%
dplyr::select(marital,
degree,
sex)
reduced_data <- na.omit(reduced_data)
# changing everything to 1 and -1 to make it all 2 levels
#yes's
reduced_data["marital"][reduced_data["marital"] == 2] <- 1
reduced_data["degree"][reduced_data["degree"] == 3] <- 1
reduced_data["degree"][reduced_data["degree"] == 4] <- 1
# no's
reduced_data["marital"][reduced_data["marital"] == 3] <- -1
reduced_data["marital"][reduced_data["marital"] == 4] <- -1
reduced_data["marital"][reduced_data["marital"] == 5] <- -1
reduced_data["degree"][reduced_data["degree"] == 0] <- -1
reduced_data["degree"][reduced_data["degree"] == 1] <- 1
reduced_data["degree"][reduced_data["degree"] == 2] <- 1
reduced_data["sex"][reduced_data["sex"] == 2] <- -1 #female
# only keeping the unique rows from the data set (8 row)
reduced_data <- unique(reduced_data)
# adding another column that puts all the numbers together (makes it easier to code the response column)
reduced_data$n <- paste(reduced_data$marital,
reduced_data$degree,
reduced_data$sex)
reduced_data <- reduced_data %>% arrange(n)
# extracting the variables I am concerned with, including the response
reduced_data_income <-
raw_data %>%
dplyr::select(marital,
degree,
sex,
realinc)
# getting rid of the NA values from the data set
reduced_data_income <- na.omit(reduced_data_income)
# changing everything to 1 and -1
#yes's
reduced_data_income["marital"][reduced_data_income["marital"] == 2] <- 1
reduced_data_income["degree"][reduced_data_income["degree"] == 3] <- 1
reduced_data_income["degree"][reduced_data_income["degree"] == 4] <- 1
# no's
reduced_data_income["marital"][reduced_data_income["marital"] == 3] <- -1
reduced_data_income["marital"][reduced_data_income["marital"] == 4] <- -1
reduced_data_income["marital"][reduced_data_income["marital"] == 5] <- -1
reduced_data_income["degree"][reduced_data_income["degree"] == 0] <- -1
reduced_data_income["degree"][reduced_data_income["degree"] == 1] <- 1
reduced_data_income["degree"][reduced_data_income["degree"] == 2] <- 1
reduced_data_income["sex"][reduced_data_income["sex"] == 2] <- -1 #female
# only keeping the unique rows from the data set (166 row)
reduced_data_income <- unique(reduced_data_income)
# adding another column that puts all the numbers together (makes it easier to code the response column)
# same n variable as in the previous data set
reduced_data_income$n <- paste(reduced_data_income$marital,
reduced_data_income$degree,
reduced_data_income$sex)
reduced_data_income <- reduced_data_income %>% arrange(n)
# Family income in 1972-2006 surveys in constant dollars
# gives the average of all of the incomes from each unique combination of sex, marital, and degree
income_avg <- aggregate(reduced_data_income$realinc, list(reduced_data_income$n), mean)
# add the averages to the redced data set matching the unique combinations
reduced_data$realinc <- round(income_avg$x,0)
# final data set with 8 runs
# same as reduced data set without the n variable
data_final <- reduced_data[,-c(4)]
data_final <- data_final %>%
dplyr::select(sex,
degree,
marital,
realinc)
data_table_1 <- data.frame(Run = c(1,2,3,4,5,6,7,8),
Sex = data_final$sex,
Degree = data_final$degree,
Marital = data_final$marital,
Income = data_final$realinc)
# adding a 1 and 2 to split the unique combination of sex, marital and degree in 2
# each unique combination of the three variables shows up twice
a <- c(1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,
1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,
1,1,1,1,1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,2,2,2,2,
1,1,1,1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,2,2,2,2,
1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,2,
1,1,1,1,1,1,
2,2,2,2,2,2,2,
1,1,1,1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,2,2,2,2,
1,1,1,1,1,1,1,1,1,1,1,1,
2,2,2,2,2,2,2,2,2,2,2,2,2)
# adding the a strng to the reduced income data set
reduced_data_income$a <- a
# adding another column that puts all the numbers together (makes it easier to code the response column)
reduced_data_income$n2 <- paste(reduced_data_income$marital,
reduced_data_income$degree,
reduced_data_income$sex,
reduced_data_income$a)
# gives the average of all of the incomes from each unique combination of sex, marital, and degree
# where each unique combination is considered twice
income_avg1 <- aggregate(reduced_data_income$realinc, list(reduced_data_income$n2), mean)
# final data set with 16 runs
# two replicated runs
data_final16 <- data.frame(sex = rep(reduced_data$sex, each = 2),
degree = rep(reduced_data$degree, each = 2),
marital = rep(reduced_data$marital, each = 2))
data_final16$realinc <- round(income_avg1$x,0)
data_table_2 <- data.frame(Run = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16),
Sex = data_final16$sex,
Degree = data_final16$degree,
Marital = data_final16$marital,
Income = data_final16$realinc)
#table of variables that I am concerned with
data_table_1 %>%
dplyr::select(Run, Sex, Degree, Marital, Income) %>%
slice(1:8) %>%
kable(
caption = "Factorial Design",
col.names = c("Run" ,"Sex", "Degree Status", "Marital Status", "Total Income"),
digits = 1,
booktabs = TRUE,
linesep = "") %>%
kableExtra::kable_styling(latex_options = "hold_position")
# The cube shows how this design produces 12 comparisons along the 12 edges of the cube
# four measures of the effect of sex change;
# four measures of the effect of marital status change;
# four measures of the effect of degree change.
# On each edge of the cube only one factor is changed with the other two held constant
c_plot <- lm(realinc~marital*degree*sex,data = data_final)
cubePlot(c_plot,"marital","degree","sex",main = "Cube plot for Income")
op <- par(mfrow=c(1,3), mar=c(4,4,4,1), oma=c(0.5,0.5,0.5,0.5))
sex_degree <- interaction.plot(data_final$sex,data_final$degree,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Degree",
ylab = "Mean yield",
main = "sex and degree status")
sex_marital <- interaction.plot(data_final$sex,data_final$marital,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Marital",
ylab = "Mean yield",
main = "sex and marital status")
marital_degree <- interaction.plot(data_final$marital,data_final$degree,data_final$realinc, type = "l",
xlab = "Marital",trace.label = "Degree",
ylab = "Mean yield",
main = "marital status and degree status")
par(op)
op <- par(mfrow=c(1,3), mar=c(4,4,4,1), oma=c(0.5,0.5,0.5,0.5))
sex_degree <- interaction.plot(data_final$sex,data_final$degree,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Degree",
ylab = "Mean yield",
main = "sex and degree status")
sex_marital <- interaction.plot(data_final$sex,data_final$marital,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Marital",
ylab = "Mean yield",
main = "sex and marital status")
marital_degree <- interaction.plot(data_final$marital,data_final$degree,data_final$realinc, type = "l",
xlab = "Marital",trace.label = "Degree",
ylab = "Mean yield",
main = "marital status and degree status")
par(op)
library(readr)
reduced_data <- read_csv("~/Desktop/STA304/paper 3/gss_analysis/inputs/data/reduced_data.csv")
View(reduced_data)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(dplyr)
library(knitr)
library(patchwork)
library(tidyr)
library(haven)
library(FrF2)
library(BsMD)
library(gridExtra)
raw_data <- haven::read_dta("/Users/krupalibhavsar/Desktop/STA304/paper 3/gss_analysis/inputs/data/2021_stata/gss2021.dta")
View(raw_data)
View(raw_data)
View(data_final)
View(data_final16)
View(data_final16)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(dplyr)
library(knitr)
library(patchwork)
library(tidyr)
library(haven)
library(FrF2)
library(BsMD)
library(gridExtra)
raw_data <- haven::read_dta("/Users/krupalibhavsar/Desktop/STA304/paper 3/gss_analysis/inputs/data/2021_stata/gss2021.dta")
# The cube shows how this design produces 12 comparisons along the 12 edges of the cube
# four measures of the effect of sex change;
# four measures of the effect of marital status change;
# four measures of the effect of degree change.
# On each edge of the cube only one factor is changed with the other two held constant
c_plot <- lm(realinc~marital*degree*sex,data = data_final)
cubePlot(c_plot,"marital","degree","sex",main = "Cube plot for Income")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(dplyr)
library(knitr)
library(patchwork)
library(tidyr)
library(haven)
library(FrF2)
library(BsMD)
library(memisc)
raw_data <- haven::read_dta("/Users/krupalibhavsar/Desktop/STA304/paper 3/gss_analysis/inputs/data/2021_stata/gss2021.dta")
# two way interaction between sex and degree
sex_degree <- interaction.plot(data_final$sex,data_final$degree,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Degree",
ylab = "Mean yield")
# two way interaction between sex and marital status
sex_marital <- interaction.plot(data_final$sex,data_final$marital,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Marital",
ylab = "Mean yield")
# two way interaction between marital status and degree
marital_degree <- interaction.plot(data_final$marital,data_final$degree,data_final$realinc, type = "l",
xlab = "Marital",trace.label = "Degree",
ylab = "Mean yield")
# two way interaction between sex and degree
sex_degree <- interaction.plot(data_final$sex,data_final$degree,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Degree",
ylab = "Mean yield",
main = "sex and degree status")
# two way interaction between sex and marital status
sex_marital <- interaction.plot(data_final$sex,data_final$marital,data_final$realinc, type = "l",
xlab = "Sex",trace.label = "Marital",
ylab = "Mean yield",
main = "sex and marital status")
# two way interaction between marital status and degree
marital_degree <- interaction.plot(data_final$marital,data_final$degree,data_final$realinc, type = "l",
xlab = "Marital",trace.label = "Degree",
ylab = "Mean yield",
main = "marital status and degree status")
# least squares estimates multiplied by 2
fact_mod8 <-lm(realinc ~ sex*degree*marital, data = data_final)
round(2*fact_mod8$coefficients,2)
# linear model for a 2^3 factorial design
fact_mod16 <-lm(realinc ~ sex*degree*marital, data = data_final16)
round(summary(fact_mod16)$coefficients,2)
model.matrix(fact_mod16)
# obtain 95% confidence intervals for the factorial effects we multiply the 95% confidence intervals for the regression parameters by 2
2*confint.lm(fact_mod16)
# main effect of Sex
((14642 - 16355) + (23355 - 22533) + (15327 - 18970) + (23277-23338))/4
# The main effect of Sex is:
# $Sex = \frac{(14642 - 16355) + (23355 - 22533) + (15327 - 18970) + (23277-23338)}{4} = -1148.75$
# main effect of Sex
((22533 - 16355) + (23355 - 14642) + (23338 - 18970) + (23277 - 15327))/4
# The main effect of degree status is:
# $Degree = \frac{(22533 - 16355) + (23355 - 14642) + (23338 - 18970) + (23277 - 15327)}{4} = 6802.25$
# main effect of Sex
((18970 - 16355) + (15327 - 14642) + (23338 - 22533) + (23277 - 23355))/4
# The main effect of Marital Status is:
# $Marital = \frac{(18970 - 16355) + (15327 - 14642) + (23338 - 22533) + (23277 - 23355)}{4} = 1006.75$
